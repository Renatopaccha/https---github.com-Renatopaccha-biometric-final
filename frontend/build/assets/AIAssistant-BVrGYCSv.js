import{j as e,r as l}from"./ui-vendor-CMVr8Ulj.js";import{c as M,P,S as D,u as A}from"./index-9m8eRFuV.js";import{M as _,l as T,g as z,d as O,s as q}from"./ai-Dicipo7D.js";import{T as V,C as B,L as W,X as U}from"./x-Bch8PvSe.js";import{M as K}from"./markdown-vendor-Bmy98YGG.js";import"./react-vendor-Cl23EvnB.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Y=M("bot",G);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],Z=M("file",X);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Q=M("image",J);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],se=M("paperclip",ee);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ae=M("send",te);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],le=M("user",re);function ne({sessions:s,onNewChat:a,onSelectChat:n,onDeleteChat:o,activeChatId:r}){const m=(t,x)=>{x.stopPropagation(),confirm("¬øEst√°s seguro de que deseas eliminar esta conversaci√≥n?")&&o(t)},p=t=>{try{const x=new Date(t),u=new Date().getTime()-x.getTime(),y=Math.floor(u/6e4),j=Math.floor(u/36e5),v=Math.floor(u/864e5);return y<1?"ahora mismo":y<60?`hace ${y} min`:j<24?`hace ${j}h`:v===1?"ayer":v<7?`hace ${v} d√≠as`:x.toLocaleDateString("es-ES",{month:"short",day:"numeric"})}catch{return t}};return e.jsxs("div",{className:"w-full h-full bg-white border-r border-slate-200 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-slate-200",children:e.jsxs("button",{onClick:a,className:"w-full px-4 py-3 bg-gradient-to-r from-teal-600 to-teal-700 hover:from-teal-700 hover:to-teal-800 text-white rounded-lg font-medium text-sm flex items-center justify-center gap-2 shadow-sm transition-all",style:{fontFamily:"Inter, system-ui, sans-serif"},children:[e.jsx(P,{className:"w-5 h-5"}),"Nuevo Chat"]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3",children:[e.jsx("div",{className:"mb-2 px-3",children:e.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",style:{fontFamily:"Inter, system-ui, sans-serif"},children:"Historial"})}),s.length===0?e.jsxs("div",{className:"px-3 py-8 text-center",children:[e.jsx(_,{className:"w-12 h-12 mx-auto text-slate-300 mb-3"}),e.jsx("p",{className:"text-sm text-slate-500",style:{fontFamily:"Inter, system-ui, sans-serif"},children:"No hay conversaciones a√∫n"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",style:{fontFamily:"Inter, system-ui, sans-serif"},children:"Crea una nueva para empezar"})]}):e.jsx("div",{className:"space-y-1",children:s.map(t=>e.jsxs("div",{onClick:()=>n(t.id),className:`group relative px-3 py-3 rounded-lg cursor-pointer transition-all ${r===t.id?"bg-teal-50 border border-teal-200":"hover:bg-slate-50 border border-transparent"}`,children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(_,{className:`w-4 h-4 mt-0.5 flex-shrink-0 ${r===t.id?"text-teal-600":"text-slate-400"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-sm font-medium truncate ${r===t.id?"text-teal-900":"text-slate-900"}`,style:{fontFamily:"Inter, system-ui, sans-serif"},children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx("p",{className:"text-xs text-slate-500",style:{fontFamily:"Inter, system-ui, sans-serif"},children:p(t.timestamp)}),t.message_count>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs text-slate-300",children:"‚Ä¢"}),e.jsxs("p",{className:"text-xs text-slate-500",style:{fontFamily:"Inter, system-ui, sans-serif"},children:[t.message_count," ",t.message_count===1?"mensaje":"mensajes"]})]})]})]})]}),e.jsx("div",{className:"absolute right-2 top-3 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{onClick:x=>m(t.id,x),className:"p-1.5 hover:bg-red-100 rounded text-red-600",title:"Eliminar conversaci√≥n",children:e.jsx(V,{className:"w-3.5 h-3.5"})})})]},t.id))})]}),e.jsx("div",{className:"p-4 border-t border-slate-200 bg-slate-50",children:e.jsx("p",{className:"text-xs text-slate-600 leading-relaxed",style:{fontFamily:"Inter, system-ui, sans-serif"},children:s.length===0?"Sin conversaciones guardadas":e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:s.length})," ",s.length===1?"conversaci√≥n guardada":"conversaciones guardadas"]})})})]})}const E=[{id:"gemini-pro",name:"Gemini Pro",description:"R√°pido y vers√°til"},{id:"gemini-pro-vision",name:"Gemini Pro Vision",description:"An√°lisis de im√°genes"},{id:"gemini-ultra",name:"Gemini Ultra",description:"M√°ximo rendimiento"}];function ie({chatTitle:s,selectedModel:a,onModelChange:n}){const[o,r]=l.useState(!1),m=l.useRef(null);l.useEffect(()=>{const t=x=>{m.current&&!m.current.contains(x.target)&&r(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const p=E.find(t=>t.id===a)||E[0];return e.jsx("div",{className:"bg-white border-b border-slate-200 px-6 py-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-teal-500 to-teal-600 rounded-full"}),e.jsx("h1",{className:"text-xl font-bold text-slate-900 tracking-tight",style:{fontFamily:"Inter, system-ui, sans-serif"},children:s})]}),e.jsxs("div",{className:"relative",ref:m,children:[e.jsxs("button",{onClick:()=>r(!o),className:"px-4 py-2.5 bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200 rounded-lg hover:from-purple-100 hover:to-indigo-100 transition-all flex items-center gap-3 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-purple-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-bold text-purple-900",style:{fontFamily:"Inter, system-ui, sans-serif"},children:p.name}),e.jsx("p",{className:"text-xs text-purple-700",style:{fontFamily:"Inter, system-ui, sans-serif"},children:p.description})]})]}),e.jsx(B,{className:"w-4 h-4 text-purple-600"})]}),o&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-72 bg-white border border-slate-300 rounded-lg shadow-xl z-20 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 bg-gradient-to-r from-slate-50 to-slate-100 border-b border-slate-200",children:e.jsx("p",{className:"text-xs font-bold text-slate-700 uppercase tracking-wider",style:{fontFamily:"Inter, system-ui, sans-serif"},children:"Seleccionar Modelo de IA"})}),E.map(t=>e.jsx("button",{onClick:()=>{n(t.id),r(!1)},className:`w-full text-left px-4 py-3 hover:bg-purple-50 transition-colors border-b border-slate-100 last:border-b-0 ${a===t.id?"bg-purple-50":""}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(D,{className:`w-4 h-4 mt-0.5 ${a===t.id?"text-purple-600":"text-slate-400"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm font-bold ${a===t.id?"text-purple-900":"text-slate-900"}`,style:{fontFamily:"Inter, system-ui, sans-serif"},children:t.name}),e.jsx("p",{className:"text-xs text-slate-600 mt-0.5",style:{fontFamily:"Inter, system-ui, sans-serif"},children:t.description})]}),a===t.id&&e.jsx("div",{className:"w-2 h-2 bg-purple-600 rounded-full mt-1.5"})]})},t.id))]})]})]})})}const oe={code({node:s,inline:a,className:n,children:o,...r}){const m=/language-(\w+)/.exec(n||"");return a?e.jsx("span",{className:"bg-slate-100 text-slate-800 px-1.5 py-0.5 rounded-md font-mono text-xs font-semibold border border-slate-200",...r,children:o}):e.jsxs("div",{className:"relative my-4 rounded-lg border border-slate-200 bg-slate-50 p-4 font-mono text-sm text-slate-800 shadow-sm overflow-x-auto",children:[m&&e.jsx("div",{className:"absolute top-0 right-0 px-2 py-1 text-[10px] uppercase text-slate-400 font-bold select-none",children:m[1]}),e.jsx("pre",{className:"m-0 bg-transparent p-0",children:e.jsx("code",{className:n,...r,children:o})})]})},ul:({children:s})=>e.jsx("ul",{className:"list-disc pl-4 space-y-1 my-2",children:s}),ol:({children:s})=>e.jsx("ol",{className:"list-decimal pl-4 space-y-1 my-2",children:s}),p:({children:s})=>e.jsx("p",{className:"mb-2 last:mb-0 leading-relaxed",children:s}),strong:({children:s})=>e.jsx("strong",{className:"font-bold text-slate-900",children:s}),table:({children:s})=>e.jsx("div",{className:"overflow-x-auto my-3",children:e.jsx("table",{className:"min-w-full border-collapse border border-slate-300 text-xs",children:s})}),th:({children:s})=>e.jsx("th",{className:"border border-slate-300 px-3 py-2 bg-slate-100 text-left font-bold",children:s}),td:({children:s})=>e.jsx("td",{className:"border border-slate-300 px-3 py-2",children:s})},$={fontFamily:"Inter, system-ui, sans-serif"};function ce({message:s}){const a=s.role==="user";return e.jsxs("div",{className:`flex gap-4 mb-6 ${a?"justify-end":"justify-start"}`,children:[!a&&e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center shadow-sm",children:e.jsx(Y,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:`max-w-[70%] ${a?"order-first":""}`,children:[e.jsx("div",{className:`rounded-2xl px-5 py-3.5 shadow-sm ${a?"bg-gradient-to-br from-teal-500 to-teal-600 text-white":"bg-white border border-slate-200 text-slate-900"}`,children:a?e.jsx("p",{className:"text-sm leading-relaxed",style:$,children:s.content}):e.jsx("div",{className:"prose prose-slate max-w-none text-sm dark:prose-invert break-words",children:e.jsx(K,{components:oe,children:s.content})})}),e.jsx("p",{className:`text-xs text-slate-500 mt-1.5 ${a?"text-right":"text-left"}`,style:$,children:s.timestamp})]}),a&&e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-br from-slate-600 to-slate-700 flex items-center justify-center shadow-sm",children:e.jsx(le,{className:"w-5 h-5 text-white"})})]})}const de=l.memo(ce),k={fontFamily:"Inter, system-ui, sans-serif"};function me({messages:s,isLoading:a=!1}){const n=l.useRef(null),o=()=>{n.current?.scrollIntoView({behavior:"smooth"})};return l.useEffect(()=>{o()},[s,a]),s.length===0?e.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-br from-purple-100 to-indigo-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",style:k,children:"Asistente AI de An√°lisis"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed mb-4",style:k,children:"Haz preguntas sobre tus datos biom√©dicos, sube archivos CSV o im√°genes de gr√°ficos para an√°lisis, o solicita ayuda con interpretaci√≥n estad√≠stica."}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[e.jsx("span",{className:"px-3 py-1.5 bg-slate-100 text-slate-700 rounded-full text-xs font-medium",style:k,children:"An√°lisis estad√≠stico"}),e.jsx("span",{className:"px-3 py-1.5 bg-slate-100 text-slate-700 rounded-full text-xs font-medium",style:k,children:"Interpretaci√≥n de resultados"}),e.jsx("span",{className:"px-3 py-1.5 bg-slate-100 text-slate-700 rounded-full text-xs font-medium",style:k,children:"Sugerencias de pruebas"})]})]})}):e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.map(r=>e.jsx(de,{message:r},r.id)),a&&e.jsxs("div",{className:"flex gap-4 mb-6 justify-start",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center shadow-sm",children:e.jsx(W,{className:"w-5 h-5 text-white animate-spin"})}),e.jsx("div",{className:"max-w-[70%]",children:e.jsx("div",{className:"rounded-2xl px-5 py-3.5 bg-white border border-slate-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}}),e.jsx("span",{className:"text-xs text-slate-600 ml-2",style:k,children:"Pensando..."})]})})})]}),e.jsx("div",{ref:n})]})})}const xe=l.memo(me);function he({onSendMessage:s,disabled:a=!1}){const[n,o]=l.useState(""),[r,m]=l.useState([]),p=l.useRef(null),t=l.useRef(null),x=()=>{(n.trim()||r.length>0)&&(s(n.trim(),r.length>0?r:void 0),o(""),m([]),t.current&&(t.current.style.height="auto"))},w=i=>{i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),x())},u=i=>{if(i.target.files&&i.target.files.length>0){const N=Array.from(i.target.files);m(h=>[...h,...N])}},y=i=>{m(N=>N.filter((h,C)=>C!==i))},j=i=>{o(i.target.value),i.target.style.height="auto",i.target.style.height=`${Math.min(i.target.scrollHeight,150)}px`},v=i=>i.type.startsWith("image/")?e.jsx(Q,{className:"w-4 h-4"}):e.jsx(Z,{className:"w-4 h-4"});return e.jsx("div",{className:"bg-white border-t border-slate-200 p-4 shadow-lg",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[r.length>0&&e.jsx("div",{className:"mb-3 flex flex-wrap gap-2",children:r.map((i,N)=>e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-2 bg-slate-100 border border-slate-300 rounded-lg text-sm",children:[e.jsx("div",{className:"text-slate-600",children:v(i)}),e.jsx("span",{className:"text-slate-900 max-w-[200px] truncate",style:{fontFamily:"Inter, system-ui, sans-serif"},children:i.name}),e.jsx("button",{onClick:()=>y(N),className:"text-slate-500 hover:text-red-600 transition-colors",children:e.jsx(U,{className:"w-4 h-4"})})]},N))}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("button",{onClick:()=>p.current?.click(),disabled:a,className:"flex-shrink-0 p-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Adjuntar archivo (Word, Excel, im√°genes)",children:e.jsx(se,{className:"w-5 h-5"})}),e.jsx("input",{ref:p,type:"file",multiple:!0,accept:".docx,.xlsx,.xls,.csv,.pdf,.png,.jpg,.jpeg",onChange:u,className:"hidden"}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("textarea",{ref:t,value:n,onChange:j,onKeyDown:w,disabled:a,placeholder:"Escribe tu pregunta o describe el an√°lisis que necesitas...",className:"w-full px-4 py-3 bg-white border border-slate-300 rounded-lg text-sm resize-none focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed",style:{fontFamily:"Inter, system-ui, sans-serif",minHeight:"52px",maxHeight:"150px"},rows:1}),n.length>0&&e.jsx("div",{className:"absolute bottom-2 right-3 text-xs text-slate-400",style:{fontFamily:"Inter, system-ui, sans-serif"},children:n.length})]}),e.jsx("button",{onClick:x,disabled:a||!n.trim()&&r.length===0,className:"flex-shrink-0 p-3 bg-gradient-to-r from-teal-600 to-teal-700 hover:from-teal-700 hover:to-teal-800 text-white rounded-lg transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed disabled:from-slate-300 disabled:to-slate-400",title:"Enviar mensaje (Enter)",children:e.jsx(ae,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-slate-500",style:{fontFamily:"Inter, system-ui, sans-serif"},children:[e.jsxs("span",{children:["Presiona ",e.jsx("kbd",{className:"px-1.5 py-0.5 bg-slate-100 border border-slate-300 rounded text-slate-700 font-mono",children:"Enter"})," para enviar,",e.jsx("kbd",{className:"px-1.5 py-0.5 bg-slate-100 border border-slate-300 rounded text-slate-700 font-mono ml-1",children:"Shift + Enter"})," para nueva l√≠nea"]}),e.jsx("span",{className:"text-slate-400",children:"Archivos soportados: Word (.docx), Excel (.xlsx/.xls), CSV (.csv), PDF (.pdf), Im√°genes (.png/.jpg)"})]})]})})}function ue(){const{sessionId:s}=A(),[a,n]=l.useState([]),[o,r]=l.useState(null),[m,p]=l.useState([]),[t,x]=l.useState(!1),[w,u]=l.useState(null),[y,j]=l.useState(null),v=l.useRef(a);l.useEffect(()=>{v.current=a},[a]);const i=l.useCallback(async()=>{if(!s){p([]);return}try{const c=await T(s);p(c)}catch(c){console.error("Failed to load chat sessions:",c)}},[s]);l.useEffect(()=>{i()},[i]);const N=l.useCallback(async c=>{if(s)try{const f=await z(s,c);if(f){const S=f.messages.map((d,g)=>({...d,id:`${c}-${g}`}));n(S),r(c),u(null)}}catch(f){console.error("Failed to load chat history:",f),u("No se pudo cargar el historial del chat")}},[s]),h=l.useCallback(()=>{n([]),r(null),u(null),j(null)},[]),C=l.useCallback(async c=>{if(s)try{await O(s,c)&&(p(S=>S.filter(d=>d.id!==c)),o===c&&h())}catch(f){console.error("Failed to delete chat:",f)}},[s,o,h]),F=l.useCallback(async(c,f)=>{if(!c.trim()&&(!f||f.length===0))return;j({content:c,files:f}),u(null);const S={id:Date.now().toString(),role:"user",content:f&&f.length>0?`${c}

üìé Archivos adjuntos: ${f.map(d=>d.name).join(", ")}`:c,timestamp:new Date().toISOString()};n(d=>[...d,S]),x(!0);try{const d=v.current.map(b=>({role:b.role,content:b.content,timestamp:b.timestamp})),g=await q({message:c,session_id:s||void 0,chat_id:o||void 0,history:d,files:f});if(g.success){g.chat_id&&!o&&r(g.chat_id);const b={id:(Date.now()+1).toString(),role:"assistant",content:g.response,timestamp:new Date().toISOString()};n(I=>[...I,b]),s&&i(),g.session_context_used&&console.log("‚úÖ AI used session context from dataset"),g.files_processed>0&&console.log(`‚úÖ Processed ${g.files_processed} file(s)`)}else{u(g.error||"Error desconocido");const b={id:(Date.now()+1).toString(),role:"assistant",content:g.response,timestamp:new Date().toISOString()};n(I=>[...I,b])}}catch(d){const g=d instanceof Error?d.message:"Error de conexi√≥n";u(g);let b="‚ùå No se pudo procesar tu mensaje. Por favor, verifica tu conexi√≥n e intenta nuevamente.";d instanceof Error&&(d.name==="TimeoutError"||d.message.includes("timeout")||d.message.includes("aborted")?b="‚è±Ô∏è La IA est√° tomando m√°s tiempo de lo esperado. Intenta reformular tu pregunta o dividirla en partes m√°s peque√±as.":(d.message.includes("fetch")||d.message.includes("network")||d.message.includes("conexi√≥n"))&&(b="üåê Error de conexi√≥n. Por favor, verifica tu conexi√≥n a internet e intenta nuevamente."));const I={id:(Date.now()+1).toString(),role:"assistant",content:b,timestamp:new Date().toISOString()};n(R=>[...R,I])}finally{x(!1)}},[s,o,i]),L=l.useCallback(async()=>{y&&(n(c=>c.slice(0,-2)),await F(y.content,y.files))},[y,F]),H=l.useCallback(()=>{n([]),r(null),u(null),j(null)},[]);return{messages:a,chatId:o,chatSessions:m,isLoading:t,error:w,sendMessage:F,clearChat:H,retryLastMessage:L,loadChatHistory:N,loadChatSessions:i,startNewChat:h,deleteChatSession:C}}function ve({initialChatId:s}){const{sessionId:a}=A(),{messages:n,chatId:o,chatSessions:r,isLoading:m,sendMessage:p,loadChatHistory:t,startNewChat:x,deleteChatSession:w}=ue();l.useEffect(()=>{s&&r.some(h=>h.id===s)&&o!==s&&t(s)},[s,r,o,t]);const u=()=>{x()},y=h=>{t(h)},j=h=>{w(h)},v=async(h,C)=>{await p(h,C)},i=r.find(h=>h.id===o)?.title||"Nuevo Chat";return e.jsxs("div",{className:"h-full flex bg-slate-50",children:[e.jsx("div",{className:"w-1/4 min-w-[280px] max-w-[400px]",children:e.jsx(ne,{sessions:r,onNewChat:u,onSelectChat:y,onDeleteChat:j,activeChatId:o})}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx(ie,{chatTitle:i,selectedModel:"gemini-2.5-flash",onModelChange:()=>{}}),a&&e.jsx("div",{className:"px-6 py-2 bg-blue-50 border-b border-blue-200",children:e.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-2 text-sm text-blue-800",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),e.jsxs("span",{style:{fontFamily:"Inter, system-ui, sans-serif"},children:[e.jsx("strong",{children:"Contexto activo:"})," La IA puede ver tus datos cargados y responder preguntas espec√≠ficas sobre ellos."]})]})}),e.jsx(xe,{messages:n,isLoading:m}),e.jsx(he,{onSendMessage:v,disabled:m})]})]})}export{ve as AIAssistant};
